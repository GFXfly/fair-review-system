import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
    console.log('开始添加普洱市2024年公平竞争审查情况通报案例...');

    // 1. 创建通报
    const reportData = {
        title: '普洱市2024年公平竞争审查情况通报',
        department: '普洱市市场监督管理局',
        publishDate: '2024-12-12',
        province: '云南省'
    };

    let report = await prisma.report.findFirst({
        where: { title: reportData.title }
    });

    if (!report) {
        console.log('创建新通报:', reportData.title);
        report = await prisma.report.create({
            data: reportData
        });
    } else {
        console.log('使用已有通报, ID:', report.id);
        await prisma.case.deleteMany({
            where: { reportId: report.id }
        });
    }

    // 2. 添加13个案例
    const cases = [
        // （一）违反“市场准入和退出标准”
        {
            title: '西盟县农业农村和科学技术局在询价通知书中要求提供身份证原件案',
            content: `【违规情况】西盟县农业农村和科学技术局在《西盟县2023年农业生态资源保护（渔业资源保护）项目询价通知书》中要求提供身份证原件，设置不合理的准入条件。文件规定“...（4）报名人员的身份证（原件）。”
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下：要求供应商提供身份证原件。相关文件涉嫌违反《公平竞争审查条例》“第八条...（四）设置不合理或者歧视性的准入、退出条件”的规定。`,
            violationType: '限制市场准入和退出',
            result: '已整改', // 根据通报性质推断为已整改，但通报未明确标注每个案例的结果，通常此类通报意味着已处理
            documentName: '《西盟县2023年农业生态资源保护（渔业资源保护）项目询价通知书》',
            documentOrg: '西盟县农业农村和科学技术局',
            violationClause: '《公平竞争审查条例》第八条（四）设置不合理或者歧视性的准入、退出条件',
            violationDetail: '要求供应商提供身份证原件。'
        },
        {
            title: '西盟县农业农村和科学技术局在招标文件中要求提供特定期间内的财务报表案',
            content: `【违规情况】西盟县农业农村和科学技术局在《云南省普洱市西盟县2023年增发国债高标准农田建设项目施工监理招标招标文件》中要求提供特定期间内的财务报表，设置不合理的准入条件。文件规定“...提交近三年（2020年至2022年）的经会计师事务所或审计机构审计的财务审计报告书及报表。”
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下：要求供应商提供指定期间内的财务审计报告。相关文件涉嫌违反《公平竞争审查条例》“第八条...（四）设置不合理或者歧视性的准入、退出条件”的规定。`,
            violationType: '限制市场准入和退出',
            result: '已整改',
            documentName: '《云南省普洱市西盟县2023年增发国债高标准农田建设项目施工监理招标招标文件》',
            documentOrg: '西盟县农业农村和科学技术局',
            violationClause: '《公平竞争审查条例》第八条（四）设置不合理或者歧视性的准入、退出条件',
            violationDetail: '要求供应商提供指定期间内的财务审计报告。'
        },

        // （二）违反“限制商品、要素自由流动”
        {
            title: '孟连县农业农村和科学技术局项目框架协议要求乙方在甲方注册成立公司案',
            content: `【违规情况】孟连县农业农村和科学技术局在《孟连县魔芋产业化建设项目框架协议（送审稿）》中要求乙方在甲方注册成立公司。文件规定“本协议签订后乙方在甲方所在地注册成立“孟连县魔芋产业投资开发有限公司”...”。
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下：要求乙方在甲方注册成立公司。相关文件涉嫌违反《公平竞争审查条例》“第九条...（二）排斥、限制、强制或者变相强制外地经营者在本地投资经营或者设立分支机构”的规定。`,
            violationType: '限制商品要素自由流动',
            result: '已整改',
            documentName: '《孟连县魔芋产业化建设项目框架协议（送审稿）》',
            documentOrg: '孟连县农业农村和科学技术局',
            violationClause: '《公平竞争审查条例》第九条（二）排斥、限制、强制或者变相强制外地经营者在本地投资经营或者设立分支机构',
            violationDetail: '要求乙方在甲方注册成立公司。'
        },
        {
            title: '普洱市投资促进局战略合作框架协议要求乙方在甲方成立全资子公司案',
            content: `【违规情况】普洱市投资促进局关于审定《普洱市人民政府中铁国际投资集团有限公司战略合作框架协议》（送审稿）的请示中要求乙方在甲方成立全资子公司。文件规定“...在普洱市辖区内成立全资外资子公司作为负责区域合作的平台公司，并注入5亿欧元资金作为启动资金。”
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下：要求乙方在甲方注册成立公司。相关文件涉嫌违反《公平竞争审查条例》“第九条...（二）排斥、限制、强制或者变相强制外地经营者在本地投资经营或者设立分支机构”的规定。`,
            violationType: '限制商品要素自由流动',
            result: '已整改',
            documentName: '《普洱市人民政府中铁国际投资集团有限公司战略合作框架协议》（送审稿）',
            documentOrg: '普洱市投资促进局',
            violationClause: '《公平竞争审查条例》第九条（二）排斥、限制、强制或者变相强制外地经营者在本地投资经营或者设立分支机构',
            violationDetail: '要求乙方在甲方成立全资子公司并注入启动资金。'
        },

        // （三）违反“影响生产经营成本标准”
        {
            title: '普洱市文化和旅游局平台运营维护协议给予乙方优先续约权案',
            content: `【违规情况】普洱市文化和旅游局在《普洱文旅官方微信、微博平台运营维护协议（2024年度）》给予乙方优先续约权。文件规定“...合同到期后，在同等条件下，乙方享有优先续约权...”
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下给予乙方优先续约权，相关文件涉嫌违反《公平竞争审查条例》“第十条...（二）给予特定经营者选择性、差异化的财政奖励或者补贴”的规定。`,
            violationType: '影响生产经营成本',
            result: '已整改',
            documentName: '《普洱文旅官方微信、微博平台运营维护协议（2024年度）》',
            documentOrg: '普洱市文化和旅游局',
            violationClause: '《公平竞争审查条例》第十条（二）给予特定经营者选择性、差异化的财政奖励或者补贴',
            violationDetail: '给予乙方优先续约权。'
        },
        {
            title: '普洱市商务局奖补资金管理办法把补贴对象限制为在库企业案',
            content: `【违规情况】普洱市商务局在《关于印发<普洱市2022年商贸企业奖补资金管理办法>的通知》把补贴对象限制为在库企业。文件规定“对在库一年以上的批零住餐企业（个体），年度销售（营业）额增幅 5%以上的企业给予1万元奖励...”
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下把补贴对象限制为在库企业，相关文件涉嫌违反《公平竞争审查条例》“第十条...（二）给予特定经营者选择性、差异化的财政奖励或者补贴”的规定。`,
            violationType: '影响生产经营成本',
            result: '已整改',
            documentName: '《关于印发<普洱市2022年商贸企业奖补资金管理办法>的通知》',
            documentOrg: '普洱市商务局',
            violationClause: '《公平竞争审查条例》第十条（二）给予特定经营者选择性、差异化的财政奖励或者补贴',
            violationDetail: '把补贴对象限制为在库企业。'
        },
        {
            title: '西盟县支持联农带农经营主体奖补实施细则给予特定经营者优先支持案',
            content: `【违规情况】西盟县农业农村和科学技术局西盟县人民政府办公室关于印发西盟县支持联农带农经营主体奖补实施细则的通知中给予特定经营者优先支持。文件规定“...对确定为农村致富带头人和完成乡村产业振兴带头人培育“头雁”项目全部培训任务的学员所在经营主体给予优先支持。”
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下给予特定经营者优先支持，相关文件涉嫌违反《公平竞争审查条例》“第十条...（二）给予特定经营者选择性、差异化的财政奖励或者补贴”的规定。`,
            violationType: '影响生产经营成本',
            result: '已整改',
            documentName: '《西盟县支持联农带农经营主体奖补实施细则》',
            documentOrg: '西盟县农业农村和科学技术局',
            violationClause: '《公平竞争审查条例》第十条（二）给予特定经营者选择性、差异化的财政奖励或者补贴',
            violationDetail: '给予特定经营者优先支持。'
        },
        {
            title: '西盟县经济稳增长政策措施将奖励条件限制在规上企业案',
            content: `【违规情况】西盟县人民政府在《西盟佤族自治县人民政府关于印发西盟佤族自治县2023年经济稳增长政策措施的通知》中将奖励条件限制在规上企业。文件规定“...三是对规模以上工业企业，单季度产值同比增速每超10个百分点给予2万元奖励...”
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下将奖励条件限制在规上企业，相关文件涉嫌违反《公平竞争审查条例》“第十条...（二）给予特定经营者选择性、差异化的财政奖励或者补贴”的规定。`,
            violationType: '影响生产经营成本',
            result: '已整改',
            documentName: '《西盟佤族自治县2023年经济稳增长政策措施》',
            documentOrg: '西盟县人民政府',
            violationClause: '《公平竞争审查条例》第十条（二）给予特定经营者选择性、差异化的财政奖励或者补贴',
            violationDetail: '将奖励条件限制在规上企业。'
        },
        {
            title: '孟连县林下魔芋产业发展三年行动方案给予特定经营者优惠政策案',
            content: `【违规情况】孟连县农业农村和科学技术局关于审定《孟连县林下魔芋产业发展三年行动方案（送审稿）》的请示中给予特定经营者优惠政策。文件规定“...培育1－2家产业化经营龙头企业...打造产业发展的领军力量。”
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下给予特定经营者优惠政策，相关文件涉嫌违反《公平竞争审查条例》“第十条...（二）给予特定经营者选择性、差异化的财政奖励或者补贴”的规定。`,
            violationType: '影响生产经营成本',
            result: '已整改',
            documentName: '《孟连县林下魔芋产业发展三年行动方案（送审稿）》',
            documentOrg: '孟连县农业农村和科学技术局',
            violationClause: '《公平竞争审查条例》第十条（二）给予特定经营者选择性、差异化的财政奖励或者补贴',
            violationDetail: '给予特定经营者优惠政策。'
        },
        {
            title: '孟连县牛油果产业发展实施意见给予特定经营者优惠政策案',
            content: `【违规情况】孟连县农业农村和科学技术局关于审定《关于加快推进“一县一业”牛油果产业发展的实施意见（送审稿）》的请示中给予特定经营者优惠政策。文件规定“...扶持农民专业合作社20个以上（其中，省级合作社3个以上）...”
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下给予特定经营者优惠政策，相关文件涉嫌违反《公平竞争审查条例》“第十条...（二）给予特定经营者选择性、差异化的财政奖励或者补贴”的规定。`,
            violationType: '影响生产经营成本',
            result: '已整改',
            documentName: '《关于加快推进“一县一业”牛油果产业发展的实施意见（送审稿）》',
            documentOrg: '孟连县农业农村和科学技术局',
            violationClause: '《公平竞争审查条例》第十条（二）给予特定经营者选择性、差异化的财政奖励或者补贴',
            violationDetail: '给予特定经营者优惠政策。'
        },
        {
            title: '孟连县林草产业高质量发展三年行动方案给予特定经营者优惠政策案',
            content: `【违规情况】孟连县人民政府办公室关于印发《孟连县林草产业高质量发展三年行动方案（2023—2025年）》的通知中给予特定经营者优惠政策。文件规定“...大力扶植龙头企业，积极培育种植大户、家庭林场、专业合作社等新型经营主体...”
【审查解析】上述条款在没有相关法律法规依据或者国务院规定的情况下给予特定经营者优惠政策，相关文件涉嫌违反《公平竞争审查条例》“第十条...（二）给予特定经营者选择性、差异化的财政奖励或者补贴”的规定。`,
            violationType: '影响生产经营成本',
            result: '已整改',
            documentName: '《孟连县林草产业高质量发展三年行动方案（2023—2025年）》',
            documentOrg: '孟连县人民政府办公室',
            violationClause: '《公平竞争审查条例》第十条（二）给予特定经营者选择性、差异化的财政奖励或者补贴',
            violationDetail: '给予特定经营者优惠政策。'
        },

        // （四）违反多条标准
        {
            title: '西盟县土壤普查文件违规评分及保证金无息退还案',
            content: `【违规情况】西盟县农业农村和科学技术局在《西盟县第三次全国土壤普查竞争性磋商文件》中一是把ISO系列证书作为评分，二是要求保证金退还时无息退还。
【审查解析】一是相关文件涉嫌违反《公平竞争审查条例》“第八条...（四）设置不合理或者歧视性的准入、退出条件”的规定。二是违反“第十条...（四）其他影响生产经营成本的内容”的规定。`,
            violationType: '违反多条标准',
            result: '已整改',
            documentName: '《西盟县第三次全国土壤普查竞争性磋商文件》',
            documentOrg: '西盟县农业农村和科学技术局',
            violationClause: '《公平竞争审查条例》第八条（四）、第十条（四）',
            violationDetail: '把ISO系列证书作为评分，要求保证金无息退还。'
        },
        {
            title: '西盟县防灾减灾项目询价通知书违规要求及保证金无息退还案',
            content: `【违规情况】西盟县农业农村和科学技术局在《西盟县2024年中央农业防灾减灾和水利救灾资金病虫害防治项目询价通知书》中一是要求供应商提供身份证原件。二是没有文件依据规定保证金无息退还。
【审查解析】一是相关文件涉嫌违反《公平竞争审查条例》“第八条...（四）设置不合理或者歧视性的准入、退出条件”的规定。二是相关文件涉嫌违反《公平竞争审查条例》“第十条...（四）其他影响生产经营成本的内容”的规定。`,
            violationType: '违反多条标准',
            result: '已整改',
            documentName: '《西盟县2024年中央农业防灾减灾和水利救灾资金病虫害防治项目询价通知书》',
            documentOrg: '西盟县农业农村和科学技术局',
            violationClause: '《公平竞争审查条例》第八条（四）、第十条（四）',
            violationDetail: '要求供应商提供身份证原件，要求保证金无息退还。'
        },
        {
            title: '孟连县肉牛产业项目框架协议违反多条标准案',
            content: `【违规情况】孟连县农业农村和科学技术局...《孟连县肉牛产业集群发展项目框架合作协议（送审稿）》中一是给予乙方税收优惠；二是要求乙方...注册成立独立法人资格公司；三是给予乙方优先支持。
【审查解析】违反《公平竞争审查条例》第十条（一）给予特定经营者税收优惠；第九条（二）排斥、限制...外地经营者...设立分支机构；第十条（二）给予特定经营者...财政奖励或者补贴。`,
            violationType: '违反多条标准',
            result: '已整改',
            documentName: '《孟连县肉牛产业集群发展项目框架合作协议（送审稿）》',
            documentOrg: '孟连县农业农村和科学技术局',
            violationClause: '《公平竞争审查条例》第九条（二）、第十条（一）、第十条（二）',
            violationDetail: '给予税收优惠，要求注册成立独立公司，给予优先支持。'
        },
    ];

    let count = 0;
    for (const caseData of cases) {
        await prisma.case.create({
            data: {
                ...caseData,
                province: '云南省',
                publishDate: reportData.publishDate,
                legalScope: '公平竞争审查',
                reportId: report.id
            }
        });
        console.log(`✅ 已添加案例 ${count + 1}:`, caseData.title);
        count++;
    }

    console.log(`\n处理完成，共添加 ${count} 个案例到 Report ID ${report.id}。`);
}

main()
    .catch((e) => {
        console.error(e);
        process.exit(1);
    })
    .finally(async () => {
        await prisma.$disconnect();
    });
