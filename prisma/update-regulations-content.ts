import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

async function main() {
    console.log('Updating regulations with full content...')

    // 1. Update 招标投标领域公平竞争审查规则
    const nationalRule = await prisma.regulation.findFirst({
        where: { title: '招标投标领域公平竞争审查规则' }
    })

    if (nationalRule) {
        await prisma.regulation.update({
            where: { id: nationalRule.id },
            data: {
                content: `第一章 总则

第一条 为加强和规范招标投标领域公平竞争审查，维护公平竞争市场秩序，根据《中华人民共和国招标投标法》《中华人民共和国招标投标法实施条例》等有关规定，制定本规则。

第二条 招标投标领域公平竞争审查工作，适用本规则。

第三条 本规则所称公平竞争审查，是指行政机关和法律、法规授权的具有管理公共事务职能的组织（以下统称政策制定机关）对拟制定的招标投标领域涉及经营主体经济活动的规章、行政规范性文件、其他政策性文件以及具体政策措施（以下统称政策措施）是否存在排除、限制竞争情形进行审查评估的活动。
除法律、行政法规或者国务院规定的公平竞争审查例外情形，未经公平竞争审查或者经审查存在排除、限制竞争情形的，不得出台有关政策措施。

第四条 政策制定机关履行公平竞争审查职责。政策制定机关应当确定专门机构具体负责政策措施的公平竞争审查工作。
多个部门联合制定政策措施的，由牵头部门组织开展公平竞争审查，各参与部门对职责范围内的政策措施负责。

第二章 审查标准

第五条 政策制定机关应当尊重和保障招标人组织招标、选择招标代理机构、编制资格预审文件和招标文件的自主权，不得制定以下政策措施：
（一）为招标人指定招标代理机构或者违法限定招标人选择招标代理机构的方式；
（二）为招标人指定投标资格、技术、商务条件；
（三）为招标人指定特定类型的资格审查方法或者评标方法；
（四）为招标人指定具体的资格审查标准或者评标标准；
（五）为招标人指定评标委员会成员；
（六）对于已经纳入统一的公共资源交易平台体系的电子交易系统，限制招标人自主选择；
（七）强制招标人或者招标代理机构选择电子认证服务；
（八）为招标人或者招标代理机构指定特定交易工具；
（九）为招标人指定承包商（供应商）预选库、资格库或者备选名录等；
（十）要求招标人依照本地区创新产品名单、优先采购产品名单等地方性扶持政策开展招标投标活动；
（十一）以其他不合理条件限制招标人自主权的政策措施。

第六条 政策制定机关应当落实全国统一的市场准入条件，对经营主体参与投标活动，不得制定以下政策措施：
（一）对市场准入负面清单以外的行业、领域、业务，要求经营主体在参与投标活动前取得行政许可；
（二）要求经营主体在本地区设立分支机构、缴纳税收社保或者与本地区经营主体组成联合体；
（三）要求经营主体取得本地区业绩或者奖项；
（四）设定与招标项目的具体特点和实际需要不相适应或者与合同履行无关的资质、财务、业绩、信誉等不合理条件；
（五）限定经营主体的所有制形式、组织形式或者所在地；
（六）设置或者变相设置注册资本金、资产总额、营业收入、从业人员、利润、纳税额等规模门槛，限制不同所有制形式的经营主体平等参与；
（七）限定经营主体只能选择特定代理机构作为投标保证保险或者保函的提供方；
（八）强制要求经营主体购买特定产品、设备、材料或者服务；
（九）将其他地方的行政许可、认证、备案等作为投标条件；
（十）强制或者变相强制要求经营主体在指定地点或者注册地登记注册；
（十一）以其他不合理条件限制或者排斥潜在投标人。

第七条 政策制定机关制定资格预审、评标相关政策措施，应当确保评标委员会依法履行职责，不得制定以下政策措施：
（一）直接规定评分权重或者分值，排斥或者限制具有竞争优势的经营主体参与投标；
（二）直接规定中标候选人的数量或者排序；
（三）非法干预或者影响评标委员会依法评标；
（四）以其他不合理条件限制评标委员会依法履职的政策措施。

第八条 政策制定机关制定定标相关政策措施，应当尊重和保障招标人定标权，落实招标人定标主体责任，不得制定以下政策措施：
（一）为招标人指定定标方法；
（二）为招标人指定定标单位或者定标人员；
（三）将定标权交由招标人或者其授权的评标委员会以外的其他单位或者人员行使；
（四）规定直接以抽签、摇号、抓阄等方式确定合格投标人、中标候选人或者中标人；
（五）以其他不合理条件限制招标人定标权的政策措施。

第九条 政策制定机关可以通过组织开展信用评价引导经营主体诚信守法参与招标投标活动，并可以通过制定实施相应政策措施鼓励经营主体应用信用评价结果，但应当平等对待不同地区、所有制形式的经营主体，依法保障经营主体自主权，不得制定以下政策措施：
（一）在信用信息记录、归集、共享等方面对不同地区或者所有制形式的经营主体作出区别规定；
（二）将信用评价与企业资质、业绩、奖项等挂钩，或者将信用评价结果作为市场准入、退出、招标投标、资质等级评定、行政审批等事项的直接条件；
（三）强制要求经营主体接受特定信用评价机构的评价服务；
（四）以其他不合理条件限制经营主体通过信用评价参与招标投标活动的政策措施。

第十条 政策制定机关制定涉及招标投标交易监管和服务的政策措施，应当平等保障各类经营主体参与，不得在交易流程上制定以下政策措施：
（一）规定招标投标交易服务机构行使审批、备案、监管、处罚等具有行政管理性质的职能；
（二）强制非公共资源交易项目进入公共资源交易平台交易；
（三）对能够通过告知承诺和事后核验核实真伪的事项，强制投标人在投标环节提供原件；
（四）在获取招标文件、开标环节违法要求投标人的法定代表人、技术负责人、项目负责人或者其他特定人员到场；
（五）其他不当限制经营主体参与招标投标的政策措施。

第三章 审查机制

第十一条 政策制定机关应当在制定政策措施前进行公平竞争审查，形成书面审查结论。
属于下列情形之一的，可以不进行公平竞争审查：
（一）已经通过公平竞争审查的政策措施，仅进行文字技术性修改，实质内容未发生变化的；
（二）国家机关的内部管理事务，不涉及经营主体经济活动的；
（三）政府投资项目管理过程中，仅针对特定项目管理出台的政策措施；
（四）其他依照法律、行政法规或者国务院规定可以不进行公平竞争审查的情形。

第十二条 政策制定机关应当作出符合或者不符合审查标准的书面审查结论。
适用有关法律、行政法规或者国务院规定的公平竞争审查例外情形的，应当在审查结论中说明理由。

第十三条 政策制定机关在对政策措施开展公平竞争审查过程中，应当以适当方式听取有关经营主体、行业协会商会等意见；除依法保密外，应当向社会公开征求意见。
在起草政策措施的其他环节已经向社会公开征求意见或者征求过有关方面意见的，可以不再专门就公平竞争审查征求意见。

第十四条 政策制定机关应当建立健全公平竞争审查工作档案，详细记录审查过程、审查结论、听取意见情况等。

第四章 监督管理

第十五条 地方各级招标投标指导协调部门会同招标投标行政监督部门，应当定期组织开展政策措施评估，发现违反公平竞争审查有关规定的，应当及时纠正。

第十六条 公民、法人或者其他组织认为政策措施妨碍公平竞争的，有权向政策制定机关及其上一级机关反映。
地方各级招标投标指导协调部门、招标投标行政监督部门应当建立招标投标市场壁垒线索征集机制，动态清理废止各类有违公平竞争的政策措施。

第十七条 公民、法人或者其他组织认为资格预审文件、招标文件存在排斥、限制潜在投标人不合理条件的，有权依照《招标投标法》及其实施条例相关规定提出异议和投诉。

第十八条 政策制定机关违反本规则规定，出台排除、限制竞争的政策措施，或者不履行公平竞争审查职责的，依照《中华人民共和国反垄断法》等有关规定处理。

第五章 附则

第十九条 政策制定机关作为招标人编制招标公告、资格预审文件和招标文件，以及公共资源交易平台运行服务机构制定招标投标交易服务文件，应当参照本规则开展公平竞争审查。

第二十条 本规则由国家发展改革委会同有关部门负责解释。

第二十一条 本规则自2024年5月1日起施行。`
            }
        })
        console.log('Updated: 招标投标领域公平竞争审查规则')
    }

    // 2. Update 浙江省招标投标领域公平竞争审查细则
    const zjRule = await prisma.regulation.findFirst({
        where: { title: '浙江省招标投标领域公平竞争审查细则' }
    })

    if (zjRule) {
        await prisma.regulation.update({
            where: { id: zjRule.id },
            data: {
                content: `（注：以下为该细则的核心审查标准与禁止性规定摘要，全文共46项审查标准）

一、审查范围
本细则明确了两类审查对象：
1. 招标投标领域涉及经营者经济活动的政策措施；
2. 招标文件。

二、审查标准（共7个方面46项）

（一）保障招标人组织招标及选择招标代理机构自主权
不得为招标人指定招标代理机构；不得违法限定招标人选择招标代理机构的方式；不得强制招标人选择电子认证服务等。

（二）市场准入
不得对市场准入负面清单以外的行业、领域、业务，要求经营主体在参与投标活动前取得行政许可；不得要求经营主体在本地区设立分支机构、缴纳税收社保。

（三）招标文件编制禁止性规定（21种情形）
招标人在编制招标文件时，不得设置以下限制情形：
1. 根据经营者取得业绩的区域设置差异性得分；
2. 根据经营者的所有制形式设置差异性得分；
3. 根据经营者投标产品的产地设置差异性得分；
4. 根据经营者的规模、注册地址、注册资金、市场占有率、负债率、净资产规模等设置差异性得分（国家另有规定的除外）；
5. 根据联合体成员单位的注册地址、所有制形式等设置差异性得分；
6. 直接或者变相要求优先采购在本地登记注册的经营者提供的商品或者服务；
7. 对市场准入负面清单以外的行业、领域、业务，要求投标人在参与投标活动前取得行政许可或者通过行政审批性质的前置备案程序；
8. 将在本地投资或者设立分支机构、在本地拥有一定办公面积等作为参与本地招标投标的必要条件；
9. 限定经营者缴纳保证金的形式；
10. 要求经营者从特定机构开具保函（保险）；
11. 在招标文件之外设定保证金退还的前置条件；
12. 其他涉及保证金的不合理限制措施；
13. 在信用信息记录、归集、共享等方面对不同地区或者所有制形式的经营者作出区别规定；
14. 对不同地区或者所有制形式经营者的资质、资格、业绩等采用不同信用评价标准；
15. 根据经营者的所在地区或者所有制形式采取差异化的信用监管措施；
16. 没有法定依据，限制经营者参考使用信用评价结果的自主权；
17. 规定招标投标交易服务机构行使审批、备案、监管、处罚等具有行政管理性质的职能。

三、审查程序
起草单位在政策措施起草阶段应当开展公平竞争审查，并作出是否符合公平竞争审查标准的书面审查结论。拟由县级以上人民政府出台或者提请本级人民代表大会及其常务委员会审议的政策措施，起草单位也应进行审查。

四、监督管理
市场监督管理部门将适时组织开展招标投标领域公平竞争审查大数据抽查，并按照《浙江省公平竞争审查抽查工作细则》规定落实闭环处置。`
            }
        })
        console.log('Updated: 浙江省招标投标领域公平竞争审查细则')
    }
}

main()
    .then(async () => {
        await prisma.$disconnect()
    })
    .catch(async (e) => {
        console.error(e)
        await prisma.$disconnect()
        process.exit(1)
    })
