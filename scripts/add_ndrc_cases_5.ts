import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

const reportData = {
    title: "关于违背市场准入负面清单典型案例的通报(第五批)",
    department: "国家发展和改革委员会",
    publishDate: "2023-03-16",
    province: "全国"
};

const cases = [
    {
        title: "福建省宁德市福鼎市城市管理局通过招标违规设置共享电单车企业准入障碍",
        content: "2020年11月，福建省宁德市福鼎市城市管理局将共享电单车占用福鼎市城区市政道路基础设施资源三年使用权分为2500辆、2000辆、1500辆、1000辆4宗标的进行拍卖，并于同月与4家中标企业签订《共享电单车运营协议书》。该行为导致其他共享电单车企业无法进入当地市场开展经营，违反了市场准入负面清单制度有关要求。",
        violationType: "影响市场准入和退出",
        result: "已废止",
        province: "福建省宁德市福鼎市",
        documentName: "《共享电单车运营协议书》及相关文件",
        documentOrg: "福建省宁德市福鼎市城市管理局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "将共享电单车占用福鼎市城区市政道路基础设施资源三年使用权进行拍卖并与4家中标企业签订排他协议"
    },
    {
        title: "福建省南平市光泽县国资公司通过竞争性谈判违规设置共享电单车企业准入障碍",
        content: "2021年1月，福建省南平市光泽县国资公司通过竞争性谈判，与福建某公司签订政府采购合同，由该公司对城区共享电单车项目开展投资与运营，导致其他共享电单车企业无法进入当地市场开展经营，违反了市场准入负面清单制度有关要求。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "福建省南平市光泽县",
        documentName: "政府采购合同",
        documentOrg: "福建省南平市光泽县国资公司",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "通过竞争性谈判与单一公司签订排他合同"
    },
    {
        title: "福建省宁德市霞浦县城市管理局通过招标违规设置共享单车企业准入障碍",
        content: "2021年10月，福建省宁德市霞浦县城市管理局通过公开招标，确定杭州某公司和北京某公司为本地区共享单车运营企业，该行为导致其他共享单车企业无法进入当地市场开展经营，违反了市场准入负面清单制度有关要求。",
        violationType: "影响市场准入和退出",
        result: "已废止",
        province: "福建省宁德市霞浦县",
        documentName: "相关招标文件",
        documentOrg: "福建省宁德市霞浦县城市管理局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "通过招标确定特定两家公司为本地区共享单车运营企业，排斥其他竞争者"
    },
    {
        title: "福建省南平市延平区城市管理局通过共享电单车经营权拍卖违规设置共享电单车企业准入障碍",
        content: "2022年10月，福建省南平市延平区城市管理局组织公开招标，以“转让共享电单车经营权”名义招租采购，中标企业将独占招标范围内共享电单车经营权。目前，该项目正处于招标阶段，暂未与相关企业签订中标合同。",
        violationType: "影响市场准入和退出",
        result: "已终止",
        province: "福建省南平市延平区",
        documentName: "相关招标文件",
        documentOrg: "福建省南平市延平区城市管理局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "以“转让共享电单车经营权”名义招租采购，导致中标企业独占经营权"
    },
    {
        title: "福建省龙岩市长汀县城市管理局通过招标违规设置共享电单车企业准入障碍并违规收费",
        content: "2022年11月，福建省龙岩市长汀县城市管理局组织《龙岩市长汀县共享电动自行车运营项目》公开招标，将长汀县共享电单车运营权，以每个合同包1000辆，每辆基础管理费最低限价50元/月的方式，分两个合同包向社会公开招标。同月两家共享单车企业分别以每辆基础管理费57元/月、68元/月中标。该行为导致其他共享电单车企业无法进入当地市场开展经营，违反了市场准入负面清单制度有关要求。",
        violationType: "影响市场准入和退出",
        result: "已废止",
        province: "福建省龙岩市长汀县",
        documentName: "相关招标文件",
        documentOrg: "福建省龙岩市长汀县城市管理局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "通过招标将运营权排他授权给两家企业，并收取管理费"
    },
    {
        title: "福建省交通厅未按相关规定开展超限通行证审批，影响企业正常进入相关行业开展经营",
        content: "2021年3月，江苏省某物流公司在福建省福清市江阴镇某国际产业园运输风电设备时，被福建省交通厅告知相关护送车不达标。该公司表示公司具备合法合规营业资质，多次申请超限运输通行证均未通过，也未被告知不通过原因，企业无法合规开展相关运营活动。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "福建省",
        documentName: "",
        documentOrg: "福建省交通厅",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "未按规定开展超限通行证审批，未告知不通过原因"
    },
    {
        title: "福建省泉州市丰泽区市场监管局有关业务受理流程不规范导致准入障碍",
        content: "2021年4月，福建泉州市一市民向丰泽区城东市场监督管理所申请注册个体工商户营业执照，城东市场监管所以其经营范围有问题为由不予审批。该市民表示其在惠安县和台商投资区也注册过相同经营范围的营业执照。泉州市丰泽区市场监管局表示，丰泽区审批要求与其他区域不一样，仍不予以办理。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "福建省泉州市丰泽区",
        documentName: "",
        documentOrg: "福建省泉州市丰泽区市场监管局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "业务受理流程不规范，以经营范围有问题为由不予审批，与其他区域标准不一"
    },
    {
        title: "福建省泉州市行政服务中心未及时为企业办理卫生许可证延续业务导致准入障碍",
        content: "2021年10月，福建某纸业公司向福建省泉州市行政服务中心（东海）的卫健委窗口申请办理卫生许可证延续业务，于2021年11月初按要求提交完整申请材料。12月初该企业前往窗口咨询，被告知“需再等两天，待上级回来后才能办理”，此时企业才收到办件编号。直至该企业卫生许可证到期，延续业务仍未成功办理。该企业商品被电商平台下架，影响了企业形象和正常生产运营。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "福建省泉州市",
        documentName: "",
        documentOrg: "福建省泉州市行政服务中心",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "未及时办理卫生许可证延续业务，拖延审批"
    },
    {
        title: "福建省泉州市鲤城区住建局违规增设审批条件导致准入障碍",
        content: "2020年12月，福建泉州市某企业在福建省网上办事大厅的工程审批网申请办理消防设计审查及施工许可证，在报二次装修施工许可证时，福建省泉州市鲤城区住建局给予退件暂不审批，要求提供泉州市自然资源和规划局“建设活动的建设工程规划许可证明文件”。泉州市自然资源和规划局表示，该项目为KTV装修，属于正常改造无需审批，无需出具规划证明。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "福建省泉州市鲤城区",
        documentName: "",
        documentOrg: "福建省泉州市鲤城区住建局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "违规增设审批条件，要求提供无需提供的规划证明文件"
    },
    {
        title: "福建省福州市福清市文旅局违规增设审批条件导致准入障碍",
        content: "2021年1月，福建省福州市福清市某舞厅在办理娱乐经营许可证时，福清市文旅局要求其提供市生态环境局出具的“建设项目环境影响登记表备案回执”。申请人咨询市生态环境局，被告知福建省已经取消“建设项目环境影响登记表备案回执”，市生态环境局不予开具相关文件。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "福建省福州市福清市",
        documentName: "",
        documentOrg: "福建省福州市福清市文旅局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "违规增设审批条件，要求提供已取消的备案回执"
    },
    {
        title: "福建省三明市将乐县交通局违规设置准入条件，限制外地企业进入当地市场经营",
        content: "2021年1月，福建省三明市将乐县交通局在组织文博小镇旅游通道项目招标时，未参照福建省交通运输厅的招标文件范本（未使用合理低价+信用分的评标办法）组织招标，把企业在当地的纳税情况作为评分标准。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "福建省三明市将乐县",
        documentName: "文博小镇旅游通道项目招标文件",
        documentOrg: "福建省三明市将乐县交通局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "把企业在当地的纳税情况作为评分标准"
    },
    {
        title: "福建省青少年篮球培训相关审批条件不明确导致准入障碍",
        content: "2021年9月，福建省泉州市某青少年篮球培训机构在特许经营备案时，被丰泽区商务局要求提供区教育局或文体局的经营许可证。区教育局表示开办篮球培训机构不在其管辖范围，区文体局表示其只负责高危运动（攀岩等）等机构审批，导致该机构无法备案经营。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "福建省泉州市",
        documentName: "",
        documentOrg: "福建省泉州市丰泽区商务局等",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "审批条件不明确，部门间推诿，导致机构无法备案"
    },
    {
        title: "湖南省怀化市某公司未经许可经营旅游业务",
        content: "湖南省怀化市文化旅游广电体育局执法人员执法检查时发现，某农业开发有限公司怀化分公司以有政府扶持为幌子，推出“乡村振兴体验之旅”三日游活动，在未取得旅行社业务经营许可证的情况下向旅游者提供旅游服务。违反《市场准入负面清单（2022年版）》第71条“未获得许可，不得设立旅行社或经营特定旅游业务”有关规定。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "湖南省怀化市",
        documentName: "",
        documentOrg: "湖南省怀化市文化旅游广电体育局",
        violationClause: "《市场准入负面清单（2022年版）》第71条",
        violationDetail: "未取得旅行社业务经营许可证经营旅游业务"
    },
    {
        title: "贵州省遵义市正安县综合行政执法局违规设置市场准入条件，限制市场主体平等进入瓶装燃气经营市场",
        content: "2017年，贵州省遵义市正安县综合行政执法局（原城镇管理局）印发《关于进一步落实城镇燃气安全生产企业主体责任制的通知》，将“必须挂靠公司经营”“提供挂靠公司的审查意见”等作为办理城镇燃气经营许可证和年审的前置条件，排斥独立市场主体参与瓶装燃气经营市场竞争。",
        violationType: "影响市场准入和退出",
        result: "已废止",
        province: "贵州省遵义市正安县",
        documentName: "《关于进一步落实城镇燃气安全生产企业主体责任制的通知》",
        documentOrg: "贵州省遵义市正安县综合行政执法局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "将“必须挂靠公司经营”等作为办理许可证的前置条件"
    },
    {
        title: "浙江省宁波市镇海区有关交通运输部门违规增设机动车维修企业准入备案条件",
        content: "浙江省宁波市镇海区交通运输综合执法队二中队在办理机动车维修企业备案事项时，要求企业完成现场核查后再进行备案，违背了《交通运输部关于修改<机动车维修管理规定>的决定》（交通运输部令2019年第20号）明确的该事项直接备案的实施要求。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "浙江省宁波市镇海区",
        documentName: "",
        documentOrg: "浙江省宁波市镇海区交通运输综合执法队",
        violationClause: "《交通运输部关于修改<机动车维修管理规定>的决定》",
        violationDetail: "违规增设备案前现场核查环节"
    },
    {
        title: "福建省漳州市漳浦县城市管理局通过招标违规设置共享单车企业准入障碍",
        content: "2022年8月，福建省漳州市漳浦县城市管理局发布《漳浦县城市管理局漳浦县主城区共享单车投放运营项目公开招标公告》，向社会公开招标2家运营商，在漳浦县主城区公共空间投放共享单车（共享电动单车）4000辆，并统一负责主城区共享单车项目建设、运营、维护、保养、调度管理。10月，漳州市漳浦县城市管理局与两家中标企业签订《漳浦县主城区共享单车投放运营项目协议书》，协议期为三年。该行为导致其他共享单车企业无法进入当地市场开展经营，违反了市场准入负面清单制度有关要求。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "福建省漳州市漳浦县",
        documentName: "《漳浦县主城区共享单车投放运营项目公开招标公告》",
        documentOrg: "福建省漳州市漳浦县城市管理局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "通过招标确定特定运营商并签订排他协议"
    },
    {
        title: "广西壮族自治区柳州市快递协会违规收取三轮车验车费用，增加市场主体准入负担",
        content: "2020年1月至2021年7月，广西壮族自治区柳州市快递协会受柳州市邮政管理局委托，对柳州市快递服务企业用于从事邮件、快递收寄和投递业务的电动三轮车辆开展统一标识及验车服务。该协会除按要求收取有关车辆标识牌成本费用外，还超越权限设置验车费项目，即按50元/辆/年的收费标准收取会员企业用于从事快递业务的电动三轮车验车费，共收取23.27万元。",
        violationType: "影响生产经营成本",
        result: "已整改",
        province: "广西壮族自治区柳州市",
        documentName: "",
        documentOrg: "广西壮族自治区柳州市快递协会",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "违规超越权限设置验车费项目并收费"
    },
    {
        title: "湖北省十堰市郧阳区自然资源和规划局违规设置采矿权相关市场准入条件，限制非国有企业及外地企业准入经营",
        content: "2022年5月10日，湖北省十堰市郧阳区自然资源和规划局发布《十堰市郧阳区白庙山矿区建筑用白云岩矿采矿权拍卖出让公告》，要求竞买人必须具备“具有独立法人资格的国有或国有控股企业，实缴注册资金2亿元以上；竞得人须承诺在郧阳区境内投资不低于30亿元打造一个产业园区”“竞买人在资质审查截止时间前提供十堰市境内任何银行的履约保函”等资格条件。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "湖北省十堰市郧阳区",
        documentName: "《十堰市郧阳区白庙山矿区建筑用白云岩矿采矿权拍卖出让公告》",
        documentOrg: "湖北省十堰市郧阳区自然资源和规划局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "要求竞买人必须是国有企业，承诺巨额投资，限制外地及非国有企业"
    },
    {
        title: "中国播音主持网违规从事互联网新闻信息服务",
        content: "中国播音主持网在未取得互联网新闻信息服务许可情况下，违规从事互联网新闻信息服务，且公开招聘特约“记者”。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "全国",
        documentName: "",
        documentOrg: "中国播音主持网",
        violationClause: "《互联网新闻信息服务管理规定》第二十二条",
        violationDetail: "未取得许可违规从事互联网新闻信息服务"
    },
    {
        title: "湖北省襄阳市行政审批局以行政手段干预限制外地市场主体进入本地工程建设领域经营",
        content: "2021年9月，湖北省襄阳市行政审批局联合8部门印发《襄阳市工程建设招标投标信用评价细则》。2022年5月，襄阳市行政审批局开发并运行襄阳市工程建设招标投标综合信用评价系统，对经营者招投标信用进行评价审核。在信用评分审核过程中，只认可经营者在襄阳市的纳税证明、社保缴费证明等，对于经营者在襄阳市外的纳税证明、社保缴费证明等不予认可，排斥经营者在外地的经营业绩，变相限制外地经营者在本地公平参与招投标活动。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "湖北省襄阳市",
        documentName: "《襄阳市工程建设招标投标信用评价细则》",
        documentOrg: "湖北省襄阳市行政审批局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "信用评分只认可本地纳税和社保证明，排斥外地业绩"
    },
    {
        title: "福建省福州市晋安区城乡建设局设置小规模工程承发包领域准入条件，限制外地企业进入本地市场",
        content: "2020年6月16日，福建省福州市晋安区城乡建设局发布《关于征集第三批晋安区小规模工程承发包企业候选名册名单的公告》，将征集晋安区小规模工程承发包候选企业报名资格设定为“注册地在晋安区行政辖区的企业”，并于2020年7月建立了小规模工程承发包企业候选名库，入库企业全部为注册地在晋安区行政辖区内的企业。",
        violationType: "影响市场准入和退出",
        result: "已整改",
        province: "福建省福州市晋安区",
        documentName: "《关于征集第三批晋安区小规模工程承发包企业候选名册名单的公告》",
        documentOrg: "福建省福州市晋安区城乡建设局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "将报名资格限定为注册地在本地的企业"
    },
    {
        title: "新疆维吾尔自治区吐鲁番市应急管理局设置第三方监控服务企业准入条件，限制外地市场主体进入本地市场",
        content: "2018年3月3日，新疆维吾尔自治区吐鲁番市应急管理局以吐鲁番市安全生产委员会办公室名义印发《吐鲁番市道路运输安全生产第三方监控管理办法（试行）的通知》，限定第三方监控机构的注册地等条件，要求相关企业向吐鲁番市道路运输管理机构进行备案。2020年10月27日，印发《关于消除道路运输安全隐患的通知》，规定将全市辖区内特别是鄯善县的车辆纳入吐鲁番市某信息技术有限公司提供的第三方监控服务中。2021年3月31日，印发《督办通知》，指定由2家公司完成4G视频主动安全智能监控设备的安装工作。",
        violationType: "影响生产经营行为",
        result: "已整改",
        province: "新疆维吾尔自治区吐鲁番市",
        documentName: "《吐鲁番市道路运输安全生产第三方监控管理办法（试行）的通知》及相关文件",
        documentOrg: "新疆维吾尔自治区吐鲁番市应急管理局",
        violationClause: "违背市场准入负面清单制度",
        violationDetail: "限定第三方监控机构注册地，指定特定公司提供服务"
    }
];

async function main() {
    console.log('开始处理国改委违背市场准入负面清单典型案例(第五批)...');

    // 1. 创建或获取 Report
    let report = await prisma.report.findFirst({
        where: { title: reportData.title }
    });

    if (!report) {
        console.log(`创建新通报: ${reportData.title}`);
        report = await prisma.report.create({
            data: {
                ...reportData,
                province: "全国"
            }
        });
    } else {
        console.log(`使用已有通报: ${reportData.title} (ID: ${report.id})`);

        // 清理该Report下的旧案例
        console.log('清理该通报下的旧案例...');
        await prisma.case.deleteMany({
            where: { reportId: report.id }
        });
    }

    // 2. 添加案例并关联 Report
    let count = 0;
    for (const data of cases) {
        await prisma.case.create({
            data: {
                title: data.title,
                content: data.content,
                province: data.province,
                publishDate: reportData.publishDate,
                violationType: data.violationType,
                result: data.result,
                documentName: data.documentName,
                documentOrg: data.documentOrg,
                violationClause: data.violationClause,
                violationDetail: data.violationDetail,
                reportId: report.id
            }
        });
        console.log(`已添加并关联: ${data.title}`);
        count++;
    }

    console.log(`\n处理完成，共处理 ${count} 个案例到 Report ID ${report.id}。`);
}

main()
    .catch((e) => {
        console.error(e);
        process.exit(1);
    })
    .finally(async () => {
        await prisma.$disconnect();
    });
